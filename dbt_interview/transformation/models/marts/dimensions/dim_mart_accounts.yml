models:
  - name: dim_mart_accounts
    description: >
      Account Dimension  - Containing Account, Contact dimensional attributes and corresponding IDs. It has account_sk as hashed (PK) !.
    
    
    columns:
      - name: acc_sk  
        data_type: varchar      
        tests: 
          - primary_key:
              tags: [critical]
              config:
                severity: error 
                error_if: ">100"
                warn_if: ">10" 
                store_failures: true    
        description: "Surrogate Key , conseidered as Primary Key for the dimension"

      - name: account_id
        tests:
          - relationships:
              config:
                severity: error 
                error_if: ">100"
                warn_if: ">10" 
                store_failures: true
              to: ref('vw_int_account')
              field: account_id
        data_type: varchar
        description: "Account Id - Business key for Account"

      - name: parent_id
        data_type: varchar
        description: "Parent ID"

      - name: account_type
        tests:
          - dbt_utils.cardinality_equality:
              config:
                severity: error 
                error_if: ">100"
                warn_if: ">10" 
                store_failures: true
              field: account_type
              to: ref('vw_int_account')
        data_type: varchar
        
              
        description: "Account Types"

      - name: billing_street
        data_type: varchar
        description: "Account Billing Street"

      - name: billing_city
        tests:
          - contain_special_characters:
              config:
                severity: error 
                error_if: ">100"
                warn_if: ">25" 
                store_failures: true
        data_type: varchar
        description: "Account Billing City"

      - name: billing_state
        data_type: varchar
        description: "Account Billing State"

      - name: billing_postal_code
        data_type: bigint
        description: "Account Billing Postal Code"

      - name: billing_country
        data_type: varchar
        description: "Account Billing Country"

      - name: shipping_street
        data_type: varchar
        description: "Account Shipping Street"

      - name: shipping_city
        tests:
          - contain_special_characters:
              config:
                severity: error 
                error_if: ">100"
                warn_if: ">25" 
                store_failures: true
        data_type: varchar
        description: "Account Shipping City"

      - name: shipping_state
        data_type: varchar
        description: "Account Shipping State"

      - name: shipping_postal_code
        data_type: bigint
        description: "Account Shipping Postal Code"

      - name: shipping_country
        tests:
          - contain_special_characters:
              config:
                severity: error 
                error_if: ">100"
                warn_if: ">25" 
                store_failures: true
        data_type: varchar
        description: "Account Shipping Country"

      

      - name: contact_id
        tests:
          - relationships:
              config:
                severity: error 
                error_if: ">100"
                warn_if: ">10" 
                store_failures: true
              to: ref('vw_int_contact')
              field: contact_id
        data_type: varchar
        description: "Contact Id - Business Key for Contact"

      - name: first_name
        tests:
          - contain_special_characters:
              config:
                severity: error 
                error_if: ">100"
                warn_if: ">25" 
                store_failures: true
        data_type: varchar
        description: "Contact First Name"

      - name: last_name
        tests:
          - contain_special_characters:
              config:
                severity: error 
                error_if: ">100"
                warn_if: ">25" 
                store_failures: true
        data_type: varchar
        description: "Contact Last Name"

      - name: salutation
        data_type: varchar
        description: ""

      - name: mailing_street
        data_type: varchar
        description: "Contact Mailing Address"

      - name: mailing_city
        data_type: varchar
        description: "Contact Mailing City"

      - name: mailing_state
        data_type: varchar
        description: "Contact Mailing State"

      - name: phone
        data_type: varchar
        description: "Contact Phone"

      - name: fax
        data_type: varchar
        description: "Contact fax"

      - name: mobilephone
        data_type: varchar
        description: "Contact Phone Number"

      

      - name: is_account_deleted
        tests:
          - check_is_flag:
              config:
                store_failures: true
        data_type: bigint
        description: ""

      

      - name: is_contact_deleted
        tests:
          - check_is_flag:
              config:
                store_failures: true
        data_type: bigint
        description: ""

      - name: acc_created_date
        data_type: timestamp
        description: "Date when the account was created"

      - name: acc_modified_date
        data_type: timestamp
        description: "Date when the account was modified"

      - name: con_modified_date
        data_type: timestamp
        description: "Date when the contact was modified"

      - name: con_created_date
        data_type: timestamp
        description: "Date when the contact was created"   

      - name: account_load_date
        data_type: timestamp
        description: "Date when Data gets loaded into the Account dimension"